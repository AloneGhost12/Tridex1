 async function renderProductDetails() {
    const id = new URLSearchParams(window.location.search).get('id');
    const container = document.getElementById('product-details');
    try {
        const res = await fetch('https://tridex1.onrender.com/products'); // Updated URL
        const products = await res.json();
        const product = products.find(p => p._id === id);
        if (!product) {
            container.innerHTML = '<p style="color:red;">Product not found.</p><button class="back-btn" onclick="window.history.back()">Back</button>';
            return;
        }
        container.innerHTML = `
            <img src="${product.image}" alt="${product.name}">
            <h2>${product.name}</h2>
            <p><strong>Description:</strong> ${product.desc}</p>
            <p><strong>Price:</strong> â‚¹${product.price}</p>
            <div style="margin:18px 0;">
                <button id="add-to-cart-btn" style="padding:8px 18px; background:#28a745; color:#fff; border:none; border-radius:5px; font-size:1rem; cursor:pointer; margin-right:10px;">Add to Cart</button>
                <button id="add-to-wishlist-btn" style="padding:8px 18px; background:#ffc107; color:#333; border:none; border-radius:5px; font-size:1rem; cursor:pointer; margin-right:10px;">Add to Wishlist</button>
                <button id="buy-now-btn" style="padding:8px 18px; background:#007bff; color:#fff; border:none; border-radius:5px; font-size:1rem; cursor:pointer;">Buy Now</button>
            </div>
            <button class="back-btn" onclick="window.history.back()">Back</button>
            <div id="product-action-msg" style="margin-top:12px; color:green; font-weight:500;"></div>
        `;
        renderSimilarProducts(product, products);
        // Add to Cart
        document.getElementById('add-to-cart-btn').onclick = function() {
            let cart = [];
            try { cart = JSON.parse(localStorage.getItem('cart')) || []; } catch (e) { cart = []; }
            if (!cart.find(p => p._id === product._id)) {
                cart.push(product);
                localStorage.setItem('cart', JSON.stringify(cart));
                showActionMsg('Added to cart!');
            } else {
                showActionMsg('Already in cart!');
            }
        };
        // Add to Wishlist
        document.getElementById('add-to-wishlist-btn').onclick = function() {
            let wishlist = [];
            try { wishlist = JSON.parse(localStorage.getItem('wishlist')) || []; } catch (e) { wishlist = []; }
            if (!wishlist.find(p => p._id === product._id)) {
                wishlist.push(product);
                localStorage.setItem('wishlist', JSON.stringify(wishlist));
                showActionMsg('Added to wishlist!');
            } else {
                showActionMsg('Already in wishlist!');
            }
        };
        // Buy Now
        document.getElementById('buy-now-btn').onclick = function() {
            showActionMsg('Proceeding to buy now... (implement payment flow here)');
        };
        function showActionMsg(msg) {
            const el = document.getElementById('product-action-msg');
            el.textContent = msg;
            setTimeout(() => { el.textContent = ''; }, 2000);
        }
    } catch (e) {
        container.innerHTML = '<p style="color:red;">Failed to load product details.</p><button class="back-btn" onclick="window.history.back()">Back</button>';
    }
}
