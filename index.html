<!DOCTYPE html>
<html lang="en">
<head>
   <meta charset="UTF-8">
   <meta name="viewport" content="width=device-width, initial-scale=1.0">
   <title>Tridex</title>
   <link rel="stylesheet" href="style.css">
   <style>
       /* Responsive Navbar */
       @media (max-width: 900px) {
           header > div {
               flex-direction: column;
               align-items: flex-start !important;
           }
           nav ul {
               gap: 10px !important;
           }
           .search-bar {
               max-width: 98vw !important;
           }
       }
       @media (max-width: 600px) {
           header > div {
               flex-direction: column;
               align-items: flex-start !important;
               padding: 0 8px;
           }
           h1 {
               font-size: 1.5rem !important;
               margin-bottom: 8px !important;
           }
           nav ul {
               flex-wrap: wrap;
               gap: 6px !important;
               font-size: 0.98em;
           }
           .search-bar {
               flex-direction: column !important;
               max-width: 100vw !important;
               margin: 10px 0 0 0 !important;
               position: relative !important;
           }
           .search-bar input {
               border-radius: 5px !important;
               margin-bottom: 0;
               padding-right: 38px !important;
           }
           .search-bar button {
               border-radius: 5px !important;
               width: auto;
               position: absolute !important;
               right: 8px;
               top: 50%;
               transform: translateY(-50%);
               padding: 0 !important;
               background: none !important;
               box-shadow: none !important;
               height: 32px;
               min-width: 32px;
               display: flex;
               align-items: center;
               justify-content: center;
           }
           .search-bar .search-icon {
               font-size: 1.2em;
               color: #007bff;
           }
           #username-display {
               font-size: 0.98em !important;
           }
       }
       @media (max-width: 420px) {
           h1 {
               font-size: 1.1rem !important;
           }
           nav ul {
               font-size: 0.9em;
           }
           .product-card h3, .product-card p {
               font-size: 0.95em;
           }
       }
       /* Responsive Product Grid */
       .product-grid {
           display: grid;
           grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
           gap: 18px;
           padding: 24px 12px;
           max-width: 1200px;
           margin: 0 auto;
       }
       .product-card {
           background: #fff;
           border-radius: 8px;
           box-shadow: 0 2px 8px rgba(0,0,0,0.08);
           padding: 18px 12px;
           text-align: center;
           transition: box-shadow 0.2s;
       }
       .product-card img {
           max-width: 100%;
           max-height: 140px;
           margin-bottom: 10px;
           border-radius: 6px;
       }
       .product-card:hover {
           box-shadow: 0 4px 16px rgba(0,0,0,0.13);
       }
       /* Responsive logout button */
       @media (max-width: 600px) {
           #logout-btn {
               top: 8px !important;
               right: 8px !important;
               font-size: 0.95rem !important;
               padding: 6px 12px !important;
           }
       }
       #nav {
    display: flex;
    flex-direction: row;
    align-items: center;
    gap: 18px;
    list-style: none;
    margin: 0;
    padding: 0;
    background: none;
    position: static;
    width: auto;
}
.hamburger {
    display: none;
    flex-direction: column;
    justify-content: center;
    width: 36px;
    height: 36px;
    cursor: pointer;
    margin-left: 8px;
    z-index: 1001;
}
.hamburger span {
    height: 4px;
    width: 100%;
    background: #fff;
    margin: 4px 0;
    border-radius: 2px;
    transition: 0.3s;
    display: block;
}
@media (max-width: 900px) {
    .hamburger { display: flex; }
    #nav {
        display: none;
        flex-direction: column !important;
        align-items: center !important;
        gap: 0 !important;
        background: #222;
        position: absolute;
        top: 60px;
        left: 0;
        width: 100vw;
        padding: 0;
        z-index: 1000;
        box-shadow: 0 4px 16px rgba(0,0,0,0.13);
    }
    #nav.show {
        display: flex !important;
    }
    #nav li {
        width: 100%;
        border-bottom: 1px solid #333;
        padding: 12px 18px;
        text-align: center;
    }
    #nav li:last-child {
        border-bottom: none;
    }
    nav ul li a {
        width: 100%;
        display: block;
        color: #fff !important;
        text-decoration: none;
        text-align: center;
        font-size: 1em !important; /* Make nav text and icons smaller */
    }
    .nav-icon {
        font-size: 1.1em !important; /* Make nav icons smaller in hamburger */
    }
}
@media (max-width: 600px) {
    /* ...existing code... */
    .hamburger { margin-bottom: 8px; }
}
   </style>
</head>
<body>
    <!-- Loading animation overlay -->
    <div id="loading-overlay" style="display:flex; position:fixed; top:0; left:0; width:100vw; height:100vh; background:rgba(255,255,255,0.7); z-index:99999; align-items:center; justify-content:center;">
        <div style="border:6px solid #f3f3f3; border-top:6px solid #007bff; border-radius:50%; width:48px; height:48px; animation:spin 1s linear infinite;"></div>
    </div>
    <style>
        @keyframes spin {
            0% { transform: rotate(0deg);}
            100% { transform: rotate(360deg);}
        }
    </style>
   <header style="background-color: #333; color: white; padding: 20px 0; position:relative;">
       <div style="display:flex; align-items:center; justify-content:space-between; max-width:1200px; margin:0 auto; position:relative;">
           <div style="display:flex; align-items:center;">
               <h1 style="margin:0 24px 0 0;">Tridex</h1>
               <span id="username-display" style="margin-left:10px; font-weight:normal;"></span>
           </div>
           <!-- Hamburger icon for mobile -->
           <div class="hamburger" id="hamburger-menu" aria-label="Open navigation" tabindex="0">
               <span></span>
               <span></span>
               <span></span>
           </div>
           <nav>
               <ul id="nav" class="nav-collapsed" style="display:flex; align-items:center; gap:18px; list-style:none; margin:0; padding:0;">
                   <li class="nav"><a href="#" style="color:white; text-decoration:none;">Home</a></li>
                   <li class="nav"><a href="about.html" style="color:white; text-decoration:none;">About</a></li>
                   <li class="nav"><a href="#" style="color:white; text-decoration:none;">More</a></li>
                   <li><a href="#" class="nav nav-icon" id="userIcon" style="color:white; font-size:1.3em;">üë§</a></li>
                   <li>
                       <a href="#" class="nav nav-icon" id="mailIcon" title="Mailbox" style="color:white; font-size:1.3em; position:relative;">
                           &#9993;
                           <span id="mail-count" style="position:absolute; top:-8px; right:-10px; background:#28a745; color:#fff; border-radius:50%; font-size:0.85em; padding:2px 7px; min-width:20px; text-align:center; display:none;">0</span>
                       </a>
                   </li>
                   <li>
                       <a href="cart.html" class="nav nav-icon" id="cartIcon" title="Cart" style="color:white; font-size:1.3em; position:relative;">
                           üõí<span id="cart-count" style="position:absolute; top:-8px; right:-10px; background:#dc3545; color:#fff; border-radius:50%; font-size:0.85em; padding:2px 7px; min-width:20px; text-align:center; display:none;">0</span>
                       </a>
                   </li>
               </ul>
           </nav>
       </div>
       <form class="search-bar" id="search-form" style="max-width:600px; margin:18px auto 0 auto; display:flex; position:relative;">
           <input type="text" id="search-input" placeholder="Search..." style="flex:1; padding:8px 38px 8px 12px; border-radius:5px; border:none;">
           <button type="submit" style="position:absolute; right:4px; top:50%; transform:translateY(-50%); background:none; border:none; padding:0; cursor:pointer;">
               <span class="search-icon" style="font-size:1.2em; color:#007bff;">üîç</span>
           </button>
       </form>
       <div class="dropdown-menu" id="userDropdown" style="display:none;">
           <a href="login.html">Login</a>
           <a href="signup.html">Sign Up</a>
       </div>
   </header>
   <section class="product-grid" id="product-grid">
       <!-- Product cards will be rendered here by JS -->
   </section>
   <button id="logout-btn" style="position:fixed; top:16px; right:16px; padding:8px 18px; background:#007bff; color:#fff; border:none; border-radius:5px; font-size:1rem; cursor:pointer; display:none;">
        Logout
    </button>
    <div id="logout-popup" style="display:none; position:fixed; top:0; left:0; width:100vw; height:100vh; background:rgba(0,0,0,0.3); z-index:1000; align-items:center; justify-content:center;">
        <div style="background:#fff; padding:32px 24px; border-radius:8px; box-shadow:0 2px 12px rgba(0,0,0,0.15); min-width:260px; text-align:center;">
            <p style="margin-bottom:24px; font-size:1.1em;">Are you sure you want to logout?</p>
            <button id="popup-logout-yes" style="margin-right:16px; padding:8px 18px; background:#007bff; color:#fff; border:none; border-radius:5px; font-size:1rem; cursor:pointer;">Yes</button>
            <button id="popup-logout-no" style="padding:8px 18px; background:#eee; color:#333; border:none; border-radius:5px; font-size:1rem; cursor:pointer;">No</button>
        </div>
    </div>
    <!-- Ban popup for banned users -->
    <div id="ban-message" style="display:none; position:fixed; top:0; left:0; width:100vw; height:100vh; background:rgba(0,0,0,0.7); z-index:2000; align-items:center; justify-content:center;">
        <div style="background:#fff; padding:32px 24px; border-radius:8px; box-shadow:0 2px 12px rgba(0,0,0,0.15); min-width:260px; text-align:center;">
            <p style="margin-bottom:24px; font-size:1.2em; color:red;">You are banned.</p>
            <button id="ban-ok-btn" style="padding:8px 18px; background:#dc3545; color:#fff; border:none; border-radius:5px; font-size:1rem; cursor:pointer;">OK</button>
        </div>
    </div>
    <!-- Mailbox Modal -->
    <div id="mailbox-modal" style="display:none; position:fixed; top:0; left:0; width:100vw; height:100vh; background:rgba(0,0,0,0.3); z-index:3000; align-items:center; justify-content:center;">
        <div style="background:#fff; padding:32px 24px; border-radius:8px; box-shadow:0 2px 12px rgba(0,0,0,0.15); min-width:320px; max-width:90vw;">
            <h2 style="margin-top:0;">Mailbox</h2>
            <div id="mailbox-messages" style="max-height:300px; overflow-y:auto; margin-bottom:18px;"></div>
            <button id="close-mailbox" style="padding:8px 18px; background:#007bff; color:#fff; border:none; border-radius:5px; font-size:1rem; cursor:pointer;">Close</button>
        </div>
    </div>
    <!-- Chatbot Widget -->
    <div id="chatbot-widget" style="position:fixed; bottom:80px; right:24px; z-index:5000;">
        <button id="chatbot-toggle" style="background:#007bff; color:#fff; border:none; border-radius:50%; width:56px; height:56px; font-size:2em; cursor:pointer;">üí¨</button>
        <div id="chatbot-box" style="display:none; width:320px; background:#fff; border-radius:12px; box-shadow:0 2px 12px rgba(0,0,0,0.18); padding:0 0 12px 0;">
            <div style="background:#007bff; color:#fff; border-radius:12px 12px 0 0; padding:14px 18px; font-size:1.2em;">AI Chatbot</div>
            <div id="chatbot-messages" style="height:220px; overflow-y:auto; padding:12px;"></div>
            <form id="chatbot-form" style="display:flex; border-top:1px solid #eee; padding:8px;">
                <input id="chatbot-input" type="text" placeholder="Ask me anything..." style="flex:1; border:1px solid #ccc; border-radius:4px; padding:6px 10px; font-size:1em;" required>
                <button type="submit" style="margin-left:8px; background:#007bff; color:#fff; border:none; border-radius:4px; padding:6px 16px; font-size:1em; cursor:pointer;">Send</button>
            </form>
        </div>
    </div>
    <!-- Footer (fixed at bottom) -->
    <footer style="position:fixed; left:0; bottom:0; width:100vw; background:#222; color:#fff; text-align:center; padding:12px 0; font-size:1rem; z-index:9999;">
        &copy; 2025 Tridex. All rights reserved. Made with <span style="color:#e25555;">&#10084;&#65039;</span> by Tridex.
    </footer>
    <script>
        // --- withLoading helper for loading overlay ---
function withLoading(action) {
    return async function(...args) {
        const loadingOverlay = document.getElementById('loading-overlay');
        if (loadingOverlay) loadingOverlay.style.display = 'flex';
        try {
            await action(...args);
        } catch (error) {
            console.error('Error during action:', error);
        } finally {
            if (loadingOverlay) loadingOverlay.style.display = 'none';
        }
    };
}

// Ban check logic (must be first in script)
const username = localStorage.getItem('username');
const bannedUsers = JSON.parse(localStorage.getItem('bannedUsers') || '[]');
if (username && bannedUsers.includes(username)) {
    document.getElementById('ban-message').style.display = 'flex';
    document.body.style.overflow = 'hidden';
    document.getElementById('ban-ok-btn').onclick = function() {
        localStorage.removeItem('isLoggedIn');
        window.location.href = 'login.html';
    };
    // Stop further script execution
    throw new Error('User is banned');
}

// Fix: define verifiedUsers as an empty array to prevent JS errors
const verifiedUsers = [];

// Show/hide buttons based on login status
const isLoggedIn = localStorage.getItem('isLoggedIn');
// Display username if available
if (isLoggedIn && username) {
    document.getElementById('username-display').innerHTML =
        `Welcome, ${username} ${verifiedUsers.includes(username) ? '<span title="Verified" style="color:#1da1f2; font-size:1.1em;">&#10004;&#65039;</span>' : ''}`;
}
// Hide or show logout button
document.getElementById('logout-btn').style.display = isLoggedIn ? 'block' : 'none';
// Hide or show login/signup in dropdown and handle profile icon click
document.addEventListener('DOMContentLoaded', function() {
    const userIcon = document.getElementById('userIcon');
    const dropdown = document.getElementById('userDropdown');
    if (isLoggedIn) {
        // Remove login and signup links if logged in
        dropdown.innerHTML = '';
        // Redirect to profile page on profile icon click
        userIcon.addEventListener('click', function(e) {
            e.preventDefault();
            window.location.href = 'profile.html';
        });
    } else {
        userIcon.addEventListener('click', function(e) {
            e.preventDefault();
            dropdown.style.display = dropdown.style.display === 'block' ? 'none' : 'block';
        });
    }
    document.addEventListener('click', function(e) {
        if (!userIcon.contains(e.target) && !dropdown.contains(e.target)) {
            dropdown.style.display = 'none';
        }
    });
});

// Redirect to login if not logged in
if (!isLoggedIn) {
    document.getElementById('logout-btn').style.display = 'none';
}
// Logout button with popup confirmation
document.getElementById('logout-btn').onclick = function() {
    document.getElementById('logout-popup').style.display = 'flex';
};
document.getElementById('popup-logout-no').onclick = function() {
    document.getElementById('logout-popup').style.display = 'none';
};
document.getElementById('popup-logout-yes').onclick = function() {
    localStorage.removeItem('isLoggedIn');
    window.location.href = 'login.html';
};

// Fetch products from backend and render
        async function fetchAndRenderProducts(filter = "") {
            try {
                const res = await fetch('http://localhost:3000/products');
                let products = await res.json();
                const grid = document.getElementById('product-grid');
                grid.innerHTML = '';
                const filtered = products.filter(product =>
                    !filter ||
                    product.name.toLowerCase().includes(filter) ||
                    (product.desc && product.desc.toLowerCase().includes(filter))
                );
                if (filtered.length === 0) {
                    grid.innerHTML = '<div style="text-align:center; color:#888; font-size:1.2em; padding:32px 0;">No results found.</div>';
                    return;
                }
                filtered.forEach(product => {
                    const div = document.createElement('div');
                    div.className = 'product-card';
                    div.innerHTML = `
                        <img src="${product.image}" alt="${product.name}" style="cursor:pointer;" data-id="${product._id}">
                        <h3>${product.name}</h3>
                        <p>‚Çπ${product.price}</p>
                    `;
                    div.querySelector('img').onclick = function() {
                        window.location.href = `product-details.html?id=${product._id}`;
                    };
                    grid.appendChild(div);
                });
            } catch (e) {
                document.getElementById('product-grid').innerHTML = '<div style="text-align:center; color:#888; font-size:1.2em; padding:32px 0;">Failed to load products from database.</div>';
            }
        }
        // Initial render
        fetchAndRenderProducts();
        // Search form
        document.getElementById('search-form').onsubmit = function(e) {
            e.preventDefault();
            const filter = document.getElementById('search-input').value.trim().toLowerCase();
            fetchAndRenderProducts(filter);
        };

        // Cart icon click
        document.getElementById('cartIcon').onclick = withLoading(function(e) {
            e.preventDefault();
            window.location.href = 'cart.html';
        });

        // Mailbox open
        document.getElementById('mailIcon').onclick = withLoading(function(e) {
            e.preventDefault();
            // ...existing code for showing mailbox...
            let messages = [];
            try {
                messages = JSON.parse(localStorage.getItem('adminMessages')) || [];
            } catch (e) {
                messages = [];
            }
            const username = localStorage.getItem('username');
            const lastSeenKey = username ? `mailLastSeen_${username}` : 'mailLastSeen_guest';
            localStorage.setItem(lastSeenKey, messages.length);
            updateMailCount();
            const mailbox = document.getElementById('mailbox-modal');
            const messagesDiv = document.getElementById('mailbox-messages');
            if (messages.length === 0) {
                messagesDiv.innerHTML = '<p style="color:#888;">No messages.</p>';
            } else {
                messagesDiv.innerHTML = messages.map(msg =>
                    `<div style="border-bottom:1px solid #eee; padding:8px 0;">
                        <strong>${msg.title || 'Announcement'}</strong>
                        <div style="font-size:0.97em; margin-top:4px;">${msg.body}</div>
                        <div style="font-size:0.85em; color:#888; margin-top:2px;">${msg.date || ''}</div>
                    </div>`
                ).join('');
            }
            mailbox.style.display = 'flex';
        });

        // Close mailbox
        document.getElementById('close-mailbox').onclick = withLoading(function() {
            document.getElementById('mailbox-modal').style.display = 'none';
        });

        // Logout popup
        document.getElementById('logout-btn').onclick = withLoading(function() {
            document.getElementById('logout-popup').style.display = 'flex';
        });
        document.getElementById('popup-logout-no').onclick = withLoading(function() {
            document.getElementById('logout-popup').style.display = 'none';
        });
        document.getElementById('popup-logout-yes').onclick = withLoading(function() {
            localStorage.removeItem('isLoggedIn');
            window.location.href = 'login.html';
        });

        // Mail notification count logic
    function updateMailCount() {
        let messages = [];
        try {
            messages = JSON.parse(localStorage.getItem('adminMessages')) || [];
        } catch (e) {
            messages = [];
        }
        // Track last seen message count per user
        const username = localStorage.getItem('username');
        const lastSeenKey = username ? `mailLastSeen_${username}` : 'mailLastSeen_guest';
        const lastSeen = Number(localStorage.getItem(lastSeenKey) || 0);
        const newCount = Math.max(messages.length - lastSeen, 0);
        const mailCount = document.getElementById('mail-count');
        if (!isLoggedIn) {
            mailCount.style.display = 'none';
            return;
        }
        if (newCount > 0) {
            mailCount.textContent = newCount;
            mailCount.style.display = '';
        } else {
            mailCount.style.display = 'none';
        }
    }
    updateMailCount();

    // When mailbox is opened, mark all as seen
    document.getElementById('mailIcon').onclick = function(e) {
        e.preventDefault();
        const isLoggedIn = localStorage.getItem('isLoggedIn');
        if (!isLoggedIn) {
            alert('You must login to view your mailbox.');
            return;
        }
        // ...existing code for showing mailbox...
        let messages = [];
        try {
            messages = JSON.parse(localStorage.getItem('adminMessages')) || [];
        } catch (e) {
            messages = [];
        }
        const username = localStorage.getItem('username');
        const lastSeenKey = username ? `mailLastSeen_${username}` : 'mailLastSeen_guest';
        localStorage.setItem(lastSeenKey, messages.length);
        updateMailCount();
        const mailbox = document.getElementById('mailbox-modal');
        const messagesDiv = document.getElementById('mailbox-messages');
        if (messages.length === 0) {
            messagesDiv.innerHTML = '<p style="color:#888;">No messages.</p>';
        } else {
            messagesDiv.innerHTML = messages.map(msg =>
                `<div style="border-bottom:1px solid #eee; padding:8px 0;">
                    <strong>${msg.title || 'Announcement'}</strong>
                    <div style="font-size:0.97em; margin-top:4px;">${msg.body}</div>
                    <div style="font-size:0.85em; color:#888; margin-top:2px;">${msg.date || ''}</div>
                </div>`
            ).join('');
        }
        mailbox.style.display = 'flex';
    };

    // Fix: Ensure close button works even if DOMContentLoaded is not fired yet
    document.getElementById('close-mailbox').onclick = function() {
        document.getElementById('mailbox-modal').style.display = 'none';
    };

    // Update mail count when messages change (from other tabs)
    window.addEventListener('storage', function(e) {
        if (e.key === 'adminMessages') updateMailCount();
    });

        // Chatbot logic
        const chatbotToggle = document.getElementById('chatbot-toggle');
        const chatbotBox = document.getElementById('chatbot-box');
        const chatbotForm = document.getElementById('chatbot-form');
        const chatbotInput = document.getElementById('chatbot-input');
        const chatbotMessages = document.getElementById('chatbot-messages');

        // Ensure all chatbot elements exist before adding event listeners
        if (chatbotToggle && chatbotBox && chatbotForm && chatbotInput && chatbotMessages) {
            chatbotToggle.onclick = function() {
                chatbotBox.style.display = chatbotBox.style.display === 'none' || chatbotBox.style.display === '' ? 'block' : 'none';
            };

            function addChatMessage(sender, text) {
                const msgDiv = document.createElement('div');
                msgDiv.style.marginBottom = '10px';
                msgDiv.innerHTML = `<strong style="color:${sender==='You'?'#007bff':'#333'}">${sender}:</strong> <span>${text}</span>`;
                chatbotMessages.appendChild(msgDiv);
                chatbotMessages.scrollTop = chatbotMessages.scrollHeight;
            }

            function aiResponse(question) {
                const q = question.trim().toLowerCase();
                if (q.includes('hello') || q.includes('hi')) {
                    return "Hello! How can I help you today?";
                }
                if (q.includes('price')) {
                    return "You can view product prices on our main page.";
                }
                if (q.includes('how to buy' || q.includes('purchase'))) {
                    return "To buy a product, please log in and click on the product you want.";
                }
                if (q.includes('contact')) {
                    return "You can contact customer care at support@example.com or use the contact form.";
                }
                if (q.includes('reset password')) {
                    return "To reset your password, use the 'Forgot Password' link on the login page.";
                }
                return "Sorry, I can't answer that. Please contact customer care for further assistance.";
            }

            chatbotForm.onsubmit = function(e) {
                e.preventDefault();
                const userMsg = chatbotInput.value;
                addChatMessage('You', userMsg);
                setTimeout(() => {
                    const reply = aiResponse(userMsg);
                    addChatMessage('Bot', reply);
                }, 400);
                chatbotInput.value = '';
            };
        }

        // Cart icon logic
    function updateCartCount() {
        const isLoggedIn = localStorage.getItem('isLoggedIn');
        const username = localStorage.getItem('currentUser');
        if (!isLoggedIn || !username) {
            document.getElementById('cart-count').style.display = 'none';
            return;
        }
        // Ensure cart is isolated per user
        const cartUser = localStorage.getItem('cartUser');
        if (cartUser !== username) {
            const userCart = localStorage.getItem('cart_' + username);
            if (userCart) {
                localStorage.setItem('cart', userCart);
            } else {
                localStorage.removeItem('cart');
            }
            localStorage.setItem('cartUser', username);
        }
        let cart = [];
        try { cart = JSON.parse(localStorage.getItem('cart')) || []; } catch (e) { cart = []; }
        const count = cart.length;
        const cartCount = document.getElementById('cart-count');
        if (count > 0) {
            cartCount.textContent = count;
            cartCount.style.display = '';
        } else {
            cartCount.style.display = 'none';
        }
    }
    updateCartCount();

    // Listen for cart changes from other tabs/windows
    window.addEventListener('storage', function(e) {
        if (e.key === 'cart') updateCartCount();
    });

    // Cart icon click: show cart page or popup (redirect to cart.html)
    document.getElementById('cartIcon').onclick = function(e) {
        e.preventDefault();
        const isLoggedIn = localStorage.getItem('isLoggedIn');
        if (!isLoggedIn) {
            alert('You must login to view your cart.');
            return;
        }
        window.location.href = 'cart.html';
    };

    // If you want to update cart count after adding to cart from product-details.html,
    // you must call updateCartCount() after adding to cart, or reload the index page.

    // Hamburger menu logic
    const hamburger = document.getElementById('hamburger-menu');
    const nav = document.getElementById('nav');

    function handleResize() {
        if (window.innerWidth <= 900) {
            nav.classList.remove('show');
            nav.style.display = 'none';
        } else {
            nav.classList.remove('show');
            nav.style.display = 'flex';
        }
    }
    window.addEventListener('resize', handleResize);
    handleResize();

    hamburger.onclick = function(e) {
        e.stopPropagation();
        nav.classList.toggle('show');
        // Remove direct style manipulation, let CSS handle display
    };

    document.addEventListener('click', function(e) {
        if (window.innerWidth <= 900) {
            if (!nav.contains(e.target) && !hamburger.contains(e.target)) {
                nav.classList.remove('show');
            }
            if (e.target.tagName === 'A' && nav.contains(e.target)) {
                nav.classList.remove('show');
            }
        }
    });
    </script>
</body>
</html>